<html>
<head>
<script type="text/javascript">
var DestinationGoogleFormId = "1FAIpQLSdRMaP6VyoXWRKy4soR_RtRLL4DibFikwAYQFhb1lh2_GKx7A" // google sheet id from URL https://docs.google.com/forms/d/[...]/edit
var DestinationGoogleFormEntryId = "191679324" // thats the fieldId for the memberId //press the three vertical dashes in google forms and click on "link für Formalr mit Beispielwerten abrufen"
var DestinationGoogleSpreadsheetId = "17-hjfI9oEAsSmAEZcIkKfoMzpaTGIuJd3wVV5X6zMYY" // google spreadsheets id from URL https://docs.google.com/spreadsheets/d/[....]/edit
var DestinationGoogleSheetRange = [ "Formularantworten 1!B:G" ]
var GoogleApiKey = 'AIzaSyBlGosN-bpWSGekqiZ0GzlLxxsZcW0zlMg';  // this key is restricted to referer salsativity.github.io
var GoogleClientId = '43003984043-u7tnn8lve8psj8ogpv6h8vurm4pftah8.apps.googleusercontent.com';  // this ClientId is restricted to internal salsativity users only
      // TODO: Authorize using one of the following scopes:
      //   'https://www.googleapis.com/auth/spreadsheets'
      //   'https://www.googleapis.com/auth/spreadsheets.readonly'
var GoogleApiPermissionScope = 'https://www.googleapis.com/auth/spreadsheets.readonly';
</script>
<script type="text/javascript">var cachebuster = Math.round(new Date().getTime() / 1000);</script>
<script type="text/javascript"> document.write('<scr'+'ipt type="text/javascript" src="js/cookies.js?cachebuster=' +cachebuster+ '"></scr' + 'ipt>');</script>
<script type="text/javascript"> document.write('<scr'+'ipt type="text/javascript" src="js/queryString.js?chachbuster=' +cachebuster+ '"></scr' + 'ipt>');</script>
<script type="text/javascript"> document.write('<scr'+'ipt type="text/javascript" src="js/gapi.login.js?chachbuster=' +cachebuster+ '"></scr' + 'ipt>');</script>
<script type="text/javascript"> document.write('<scr'+'ipt type="text/javascript" src="js/gapi.read.js?chachbuster=' +cachebuster+ '"></scr' + 'ipt>');</script>
<script type="text/javascript"> document.write('<scr'+'ipt type="text/javascript" src="js/images.js?chachbuster=' +cachebuster+ '"></scr' + 'ipt>');</script>
<script>
// redirect if its a member
if (queryString("memberId") != null && getCookie("roles") != "guard") {
 var url = "https://docs.google.com/forms/d/e/" + encodeURIComponent(DestinationGoogleFormId) +"/viewform?usp=pp_url&entry."+ encodeURIComponent(DestinationGoogleFormEntryId) +"=" + encodeURIComponent(queryString("memberId"));
 window.location.href = url;
};

</script>
</head>
<header><title>salsativity.org - Registration Redirector</title></header>
<body>
<script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};gapiLoadClient()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
</script>
<br />
<div style='clear:both'><input type='text' style='float:left;font-weight:bold;width:17.5%; padding:2px; border:1px solid black' name = '0:0' id='0:0'><input type='text' style='float:left;font-weight:bold;width:5%; padding:2px; border:1px solid black' name = '0:1' id='0:1'><input type='text' style='float:left;font-weight:bold;width:17.5%; padding:2px; border:1px solid black' name = s'0:2' id='0:2'><input type='text' style='float:left;font-weight:bold;width:17.5%; padding:2px; border:1px solid black' name = '0:3' id='0:3'><input type='text' style='float:left;font-weight:bold;width:10%; padding:2px; border:1px solid black' name = '0:4' id='0:4'><input type='text' style='float:left;font-weight:bold;width:10%; padding:2px; border:1px solid black' name = '0:5' id='0:5'><input type='text' value='QR Code' style='float:left;font-weight:bold;width:10%; padding:2px; border:1px solid black' name = '0:6' id='0:6'></div>
<div style='clear:both'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '1:0' id='1:0'><input type='text' style='float:left;width:5%; padding:2px; border:1px solid black' name = '1:1' id='1:1'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '1:2' id='1:2'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '1:3' id='1:3'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' onchange='onchange="alert('value of URL field is changed');' name = '1:4' id='1:4'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' name='1:5' id='1:5'><script>document.write('<img id="1:6" name="1:6" src=https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=https://docs.google.com/forms/d/e/' + encodeURIComponent(DestinationGoogleFormId) +'/viewform?usp=pp_url'+encodeURIComponent('&')+'entry.'+ encodeURIComponent(DestinationGoogleFormEntryId) +'=' + encodeURIComponent(queryString("memberId")) +'>');</script></div>
<div style='clear:both'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '2:0' id='2:0'><input type='text' style='float:left;width:5%; padding:2px; border:1px solid black' name = '2:1' id='2:1'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '2:2' id='2:2'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '2:3' id='2:3'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' name = '2:4' id='2:4'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' name='2:5' id='2:5'></div>
<div style='clear:both'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '3:0' id='3:0'><input type='text' style='float:left;width:5%; padding:2px; border:1px solid black' name = '3:1' id='3:1'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '3:2' id='3:2'><input type='text' style='float:left;width:17.5%; padding:2px; border:1px solid black' name = '3:3' id='3:3'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' name = '3:4' id='3:4'><input type='text' style='float:left;width:10%; padding:2px; border:1px solid black' name='3:5' id='3:5'></div>
<br />
<div style='clear:both'>
<button id="signin-button" onclick="SignInClick().then(gapiLoadClient)">Sign in</button>
<button id="signout-button" onclick="signOutClick()">Sign out</button>
<button id="querySheet-button" onclick="querySheet()">QuerySheet</button>
<input type="button" value="Guard" onclick = "setCookie('roles', 'guard', '365')" />
<input type="button" value="Member" onclick = "setCookie('roles', '', '-1')" />
<input type="button" value="Display current role" onclick = "alertroles()" />
</div>
</body>
</html>
